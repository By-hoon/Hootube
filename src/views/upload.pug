extends base.pug

block content
    if errorMessage 
        span=errorMessage
 
    form(method="POST", enctype="multipart/form-data")
        label(for="video") Video File
        input(type="file", accept="video/*", required, id="video", name="video")
        input(placeholder="Title", required, type="text", name="title", maxlength: 80)
        input(placeholder="Description", required, type="text", name="description", minlength: 20)
        input(id="latlng", type="hidden", name="adress")
        input(id="koadress", type="text", placeholder="Please click a map", required)
        input(placeholder="Hashtags, separated by comma.", required, type="text", name="hashtags")
        input(type="submit", value="Upload Story")

    div(id="map" style="width:90%;height:50%;")
    script.
        function init(){
            var geocoder = new kakao.maps.services.Geocoder(),
            inputLat = document.getElementById('latlng'),
            inputAdress = document.getElementById('koadress'),
            mapContainer = document.getElementById('map'),
            mapOption = { 
                center: new kakao.maps.LatLng(36.33929480377198, 127.39343696623958),
                level: 7
            };
            var map = new kakao.maps.Map(mapContainer, mapOption);
            kakao.maps.event.addListener(map, 'click', function(mouseevent){
                var latlng = mouseevent.latLng; 
                var markerLat = latlng.getLat();
                var markerLng = latlng.getLng();
                var callback = function(result, status) {
                    if (status === kakao.maps.services.Status.OK) {
                        inputAdress.setAttribute("value",result[0].address.address_name);
                    }
                };

                geocoder.coord2Address(markerLng, markerLat, callback);
                inputLat.setAttribute("value", markerLat);
            });
        };
        init();